import{g as V,u as X,h as j,i as Z,j as ee,t as se,k as te,l as x,m as f,n as t,p as le,w as ae,q as ie,R as I,v as re,x as ue,y as ne,D as oe,z as ce,A as Ee,B as he,C as ve,E as me,F as pe,G as Be,H as P,I as $,J as b,K as ye,L as de,M as D,N as Ae}from"./app-D316l3Ix.js";const ge=["/intro.html","/","/posts/2025%E9%AB%98%E8%80%83.html","/posts/Byewhatk.html","/posts/friendlink.html","/posts/GPT%E7%BD%91%E7%AB%99%E6%94%B6%E9%9B%86%E7%AB%99.html","/posts/hanjinliang.html","/posts/newyear2025.html","/posts/RewardMe.html","/posts/shangan.html","/posts/Timeline.html","/posts/whatsblog%E4%BA%91%E7%9B%98.html","/posts/WZLN%E4%BA%91%E7%9B%98.html","/posts/%E5%9C%A8%E7%BA%BFChatGPT.html","/posts/%E6%88%91%E7%9A%84%E4%B8%96%E7%95%8C%E4%BF%AE%E6%94%B9%E7%89%88.html","/posts/%E6%88%91%E7%9A%84%E4%B8%96%E7%95%8C%E6%9C%8D%E5%8A%A1%E5%99%A8.html","/posts/%E6%89%8B%E6%9C%BA%E8%86%9C.html","/posts/%E6%91%98%E6%8A%84.html","/posts/%E6%9B%B4%E5%A4%9A%E7%BD%91%E7%AB%99.html","/posts/%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97.html","/posts/%E6%B2%B9%E7%8C%B4%E8%84%9A%E6%9C%AC.html","/posts/%E7%BD%91%E7%BB%9C%E6%B5%8B%E9%80%9F.html","/posts/%E8%AE%A2%E9%98%85%E8%BD%AC%E6%8D%A2.html","/posts/%E9%82%AE%E4%BB%B6%E8%BD%AC%E5%8F%91.html","/404.html","/posts/","/category/","/category/%E8%80%83%E8%AF%95/","/category/wzln/","/category/%E9%97%B2%E8%81%8A/","/category/%E5%AE%89%E5%88%A9/","/category/chatgpt/","/category/%E6%96%87%E7%AB%A0/","/category/%E8%84%9A%E6%9C%AC/","/category/%E8%AE%A2%E9%98%85/","/category/%E5%AE%89%E5%85%A8/","/tag/","/tag/%E8%80%83%E8%AF%95/","/tag/%E6%97%A5%E5%8E%86/","/tag/chatgpt/","/tag/%E7%BD%91%E7%AB%99%E6%94%B6%E9%9B%86/","/tag/-%E7%BD%91%E7%BB%9C/","/tag/%E5%AE%89%E5%88%A9/","/tag/%E4%BA%91%E7%9B%98/","/tag/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/","/tag/%E8%BD%AF%E4%BB%B6/","/tag/%E6%B8%B8%E6%88%8F/","/tag/%E6%9C%8D%E5%8A%A1%E5%99%A8/","/tag/%E6%89%8B%E6%9C%BA%E8%86%9C/","/tag/%E6%91%98%E6%8A%84/","/tag/%E7%BD%91%E7%BB%9C/","/tag/tampermonkey/","/tag/%E8%84%9A%E6%9C%AC/","/tag/%E6%B5%8B%E9%80%9F/","/tag/vpn/","/tag/%E7%BF%BB%E5%A2%99/","/tag/%E9%82%AE%E4%BB%B6%E8%BD%AC%E5%8F%91/","/tag/%E9%9A%90%E7%A7%81/","/article/","/star/","/timeline/"],Ce="SLIMSEARCH_QUERY_HISTORY",B=P(Ce,[]),fe=()=>{const{queryHistoryCount:a}=D;return{enabled:a>0,queryHistories:B,addQueryHistory:u=>{B.value=Array.from(new Set([u,...B.value.slice(0,a-1)]))},removeQueryHistory:u=>{B.value=[...B.value.slice(0,u),...B.value.slice(u+1)]}}},Q=a=>ge[a.id]+("anchor"in a?`#${a.anchor}`:""),De="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=D,y=P(De,[]),He=()=>({enabled:M>0,resultHistories:y,addResultHistory:r=>{{const u={link:Q(r),display:r.display};"header"in r&&(u.header=r.header),y.value=[u,...y.value.slice(0,M-1)]}},removeResultHistory:r=>{y.value=[...y.value.slice(0,r),...y.value.slice(r+1)]}}),ke=a=>{const r=oe(),u=j(),H=ce(),n=x(0),d=f(()=>n.value>0),E=Ee([]);return he(()=>{const{search:k,terminate:v}=ve(),A=pe(m=>{const{resultsFilter:w=l=>l,querySplitter:p,suggestionsFilter:S,...i}=r.value;m?(n.value+=1,k(m,u.value,i).then(l=>w(l,m,u.value,H.value)).then(l=>{n.value-=1,E.value=l}).catch(l=>{console.warn(l),n.value-=1,n.value||(E.value=[])})):E.value=[]},D.searchDelay-D.suggestDelay,{maxWait:5e3});me([a,u],([m])=>A(m.join(" "))),Be(()=>{v()})}),{isSearching:d,results:E}};var Re=V({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:r}){const u=X(),H=j(),n=Z(ee),{addQueryHistory:d,queryHistories:E,removeQueryHistory:k}=fe(),{resultHistories:v,addResultHistory:A,removeResultHistory:m}=He(),w=se(a,"queries"),{results:p,isSearching:S}=ke(w),i=te({isQuery:!0,index:0}),l=x(0),h=x(0),L=f(()=>E.value.length>0||v.value.length>0),R=f(()=>p.value.length>0),F=f(()=>p.value[l.value]||null),U=()=>{const{isQuery:e,index:s}=i;s===0?(i.isQuery=!e,i.index=e?v.value.length-1:E.value.length-1):i.index=s-1},_=()=>{const{isQuery:e,index:s}=i;s===(e?E.value.length-1:v.value.length-1)?(i.isQuery=!e,i.index=0):i.index=s+1},G=()=>{l.value=l.value>0?l.value-1:p.value.length-1,h.value=F.value.contents.length-1},O=()=>{l.value=l.value<p.value.length-1?l.value+1:0,h.value=0},Y=()=>{h.value<F.value.contents.length-1?h.value+=1:O()},z=()=>{h.value>0?h.value-=1:G()},q=e=>e.map(s=>Ae(s)?s:t(s[0],s[1])),N=e=>{if(e.type==="customField"){const s=ye[e.index]||"$content",[o,C=""]=de(s)?s[H.value].split("$content"):s.split("$content");return e.display.map(c=>t("div",q([o,...c,C])))}return e.display.map(s=>t("div",q(s)))},g=()=>{l.value=0,h.value=0,r("updateQuery",""),r("close")},W=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},n.value.queryHistory),E.value.map((e,s)=>t("div",{class:["slimsearch-result-item",{active:i.isQuery&&i.index===s}],onClick:()=>{r("updateQuery",e)}},[t($,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},e),t("button",{class:"slimsearch-remove-icon",innerHTML:b,onClick:o=>{o.preventDefault(),o.stopPropagation(),k(s)}})]))])),J=()=>t("ul",{class:"slimsearch-result-list"},t("li",{class:"slimsearch-result-list-item"},[t("div",{class:"slimsearch-result-title"},n.value.resultHistory),v.value.map((e,s)=>t(I,{to:e.link,class:["slimsearch-result-item",{active:!i.isQuery&&i.index===s}],onClick:()=>{g()}},()=>[t($,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(o=>q(o)).flat())]),t("button",{class:"slimsearch-remove-icon",innerHTML:b,onClick:o=>{o.preventDefault(),o.stopPropagation(),m(s)}})]))]));return le("keydown",e=>{if(a.isFocusing){if(R.value){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const s=F.value.contents[h.value];d(a.queries.join(" ")),A(s),u.push(Q(s)),g()}}else if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")_();else if(e.key==="Enter"){const{index:s}=i;i.isQuery?(r("updateQuery",E.value[s]),e.preventDefault()):(u.push(v.value[s].link),g())}}}),ae([l,h],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!R.value:!L.value}],id:"slimsearch-results"},a.queries.length?S.value?t(ie,{hint:n.value.searching}):R.value?t("ul",{class:"slimsearch-result-list"},p.value.map(({title:e,contents:s},o)=>{const C=l.value===o;return t("li",{class:["slimsearch-result-list-item",{active:C}]},[t("div",{class:"slimsearch-result-title"},e||n.value.defaultTitle),s.map((c,K)=>{const T=C&&h.value===K;return t(I,{to:Q(c),class:["slimsearch-result-item",{active:T,"aria-selected":T}],onClick:()=>{d(a.queries.join(" ")),A(c),g()}},()=>[c.type==="text"?null:t(c.type==="title"?re:c.type==="heading"?ue:ne,{class:"slimsearch-result-type"}),t("div",{class:"slimsearch-result-content"},[c.type==="text"&&c.header?t("div",{class:"content-header"},c.header):null,t("div",N(c))])])})])})):n.value.emptyResult:L.value?[W(),J()]:n.value.emptyHistory)}});export{Re as default};
