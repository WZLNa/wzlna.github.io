import{f as N,u as V,g as Z,h as X,j as ee,t as se,i as te,k as b,l as C,m as e,n as ae,p as le,s as re,R as T,q as ie,v as oe,x as ue,y as ce,z as ne,A as $,B as I,C as he,D as Ee,E as ve,F as de,L as me,G as pe,H as ye,I as Be,J as j,K as Ae,M as D}from"./app-DhZT1P1Q.js";const ge=["/intro.html","/","/posts/2025%E9%AB%98%E8%80%83.html","/posts/Byewhatk.html","/posts/friendlink.html","/posts/GPT%E7%BD%91%E7%AB%99%E6%94%B6%E9%9B%86%E7%AB%99.html","/posts/hanjinliang.html","/posts/huaweidevloper.html","/posts/newyear2025.html","/posts/RewardMe.html","/posts/Timeline.html","/posts/whatsblog%E4%BA%91%E7%9B%98.html","/posts/WZLN%E4%BA%91%E7%9B%98.html","/posts/%E5%8F%AF%E4%BB%A5%E6%81%A2%E5%A4%8D%E7%BD%91%E9%A1%B5%E6%B5%8F%E8%A7%88%E8%BF%9B%E5%BA%A6%E7%9A%84%E8%84%9A%E6%9C%AC.html","/posts/%E5%9C%A8%E7%BA%BFChatGPT.html","/posts/%E5%A5%BD%E5%8F%A5.html","/posts/%E6%88%91%E7%9A%84%E4%B8%96%E7%95%8C%E4%BF%AE%E6%94%B9%E7%89%88.html","/posts/%E6%88%91%E7%9A%84%E4%B8%96%E7%95%8C%E6%9C%8D%E5%8A%A1%E5%99%A8.html","/posts/%E6%89%8B%E6%9C%BA%E8%86%9C.html","/posts/%E6%8D%A2%E5%9F%9F%E5%90%8D.html","/posts/%E6%9B%B4%E5%A4%9A%E7%BD%91%E7%AB%99.html","/posts/%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97.html","/posts/%E7%BD%91%E7%BB%9C%E6%B5%8B%E9%80%9F.html","/posts/%E8%AE%A2%E9%98%85%E8%BD%AC%E6%8D%A2.html","/posts/%E9%82%AE%E4%BB%B6%E8%BD%AC%E5%8F%91.html","/404.html","/posts/","/category/","/category/%E6%96%87%E7%AB%A0/","/category/wzln/","/category/%E9%97%B2%E8%81%8A/","/category/%E5%B7%A5%E5%85%B7/","/tag/","/tag/chatgpt/","/tag/%E7%BD%91%E7%AB%99%E6%94%B6%E9%9B%86/","/tag/%E5%AE%89%E5%88%A9/","/tag/%E4%BA%91%E7%9B%98/","/tag/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/","/tag/%E6%91%98%E6%8A%84/","/tag/%E6%B8%B8%E6%88%8F/","/tag/%E6%9C%8D%E5%8A%A1%E5%99%A8/","/tag/%E9%87%8D%E8%A6%81/","/tag/%E5%B7%A5%E5%85%B7/","/tag/%E9%9A%90%E7%A7%81/","/article/","/star/","/timeline/"],fe="SLIMSEARCH_QUERY_HISTORY",y=j(fe,[]),Ce=()=>{const{queryHistoryCount:l}=D;return{enabled:l>0,queryHistories:y,addQueryHistory:u=>{y.value=Array.from(new Set([u,...y.value.slice(0,l-1)]))},removeQueryHistory:u=>{y.value=[...y.value.slice(0,u),...y.value.slice(u+1)]}}},Q=l=>ge[l.id]+("anchor"in l?`#${l.anchor}`:""),De="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:M}=D,B=j(De,[]),He=()=>({enabled:M>0,resultHistories:B,addResultHistory:o=>{{const u={link:Q(o),display:o.display};"header"in o&&(u.header=o.header),B.value=[u,...B.value.slice(0,M-1)]}},removeResultHistory:o=>{B.value=[...B.value.slice(0,o),...B.value.slice(o+1)]}}),we=l=>{const{page:o,routeLocale:u}=he(),H=Ee(),r=b(0),A=C(()=>r.value>0),h=ve([]);return de(()=>{const{search:w,terminate:d}=me(),g=ye(m=>{const{resultsFilter:k=a=>a,querySplitter:p,suggestionsFilter:S,...i}=H.value;m?(r.value+=1,w(m,u.value,i).then(a=>k(a,m,u.value,o.value)).then(a=>{r.value-=1,h.value=a}).catch(a=>{console.warn(a),r.value-=1,r.value||(h.value=[])})):h.value=[]},D.searchDelay-D.suggestDelay,{maxWait:5e3});pe([l,u],([m])=>g(m.join(" "))),Be(()=>{d()})}),{isSearching:A,results:h}};var Fe=N({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:o}){const u=V(),H=Z(),r=X(ee),{addQueryHistory:A,queryHistories:h,removeQueryHistory:w}=Ce(),{resultHistories:d,addResultHistory:g,removeResultHistory:m}=He(),k=se(l,"queries"),{results:p,isSearching:S}=we(k),i=te({isQuery:!0,index:0}),a=b(0),E=b(0),q=C(()=>h.value.length>0||d.value.length>0),F=C(()=>p.value.length>0),R=C(()=>p.value[a.value]||null),P=()=>{const{isQuery:s,index:t}=i;t===0?(i.isQuery=!s,i.index=s?d.value.length-1:h.value.length-1):i.index=t-1},U=()=>{const{isQuery:s,index:t}=i;t===(s?h.value.length-1:d.value.length-1)?(i.isQuery=!s,i.index=0):i.index=t+1},_=()=>{a.value=a.value>0?a.value-1:p.value.length-1,E.value=R.value.contents.length-1},G=()=>{a.value=a.value<p.value.length-1?a.value+1:0,E.value=0},O=()=>{E.value<R.value.contents.length-1?E.value+=1:G()},Y=()=>{E.value>0?E.value-=1:_()},x=s=>s.map(t=>Ae(t)?t:e(t[0],t[1])),z=s=>{if(s.type==="customField"){const t=ce[s.index]||"$content",[v,c=""]=ne(t)?t[H.value].split("$content"):t.split("$content");return s.display.map(n=>e("div",x([v,...n,c])))}return s.display.map(t=>e("div",x(t)))},f=()=>{a.value=0,E.value=0,o("updateQuery",""),o("close")},W=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},h.value.map((s,t)=>{const v=i.isQuery&&i.index===t;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v,onClick:()=>{o("updateQuery",s)}},e("div",[e($,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},s),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),w(t)}})]))}))])),J=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},r.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},d.value.map((s,t)=>{const v=!i.isQuery&&i.index===t;return e("li",{class:["slimsearch-record-matches",{active:v}],role:"option","aria-selected":v},e(T,{to:s.link,onClick:()=>{f()}},()=>[e($,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[s.header?e("div",{class:"slimsearch-record-content-header"},s.header):null,e("div",s.display.map(c=>x(c)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:r.value.remove,"aria-label":r.value.remove,innerHTML:I,onClick:c=>{c.preventDefault(),c.stopPropagation(),m(t)}})]))}))]));return ae("keydown",s=>{if(l.isFocusing){if(F.value){if(s.key==="ArrowUp")Y();else if(s.key==="ArrowDown")O();else if(s.key==="Enter"){const t=R.value.contents[E.value];A(l.queries.join(" ")),g(t),u.push(Q(t)),f()}}else if(s.key==="ArrowUp")P();else if(s.key==="ArrowDown")U();else if(s.key==="Enter"){const{index:t}=i;i.isQuery?(s.preventDefault(),o("updateQuery",h.value[t])):(u.push(d.value[t].link),f())}}}),le([a,E],()=>{document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active")?.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:l.queries.length?!F.value:!q.value}]},l.queries.length?S.value?e(re,{hint:r.value.searching}):F.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},p.value.map(({title:s,contents:t},v)=>{const c=a.value===v;return e("div",{class:["slimsearch-record",{active:c}],role:"group","aria-selected":c},[e("div",{class:"slimsearch-record-title"},s||r.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},t.map((n,K)=>{const L=c&&E.value===K;return e("li",{class:["slimsearch-record-matches",{active:L}],role:"option","aria-selected":L},e(T,{to:Q(n),onClick:()=>{A(l.queries.join(" ")),g(n),f()}},()=>[n.type==="text"?null:e(n.type==="title"?ie:n.type==="heading"?oe:ue,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[n.type==="text"&&n.header?e("div",{class:"slimsearch-record-content-header"},n.header):null,e("div",z(n))])]))}))])})):r.value.emptyResult:q.value?[W(),J()]:r.value.emptyHistory)}});export{Fe as default};
